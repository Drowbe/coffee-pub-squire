<div class="panel party-stats-panel">
    <div class="mvp-panel">
        <div class="mvp-panel__header">
            <i class="fas fa-trophy"></i>
            <span>Lifetime MVP Leaderboard</span>
        </div>

        {{#if hasBlacksmith}}
            {{#if leaderboard.length}}
            <div class="mvp-table" role="table">
                <div class="mvp-table__row mvp-table__row--header" role="row">
                    <span class="mvp-table__cell mvp-table__cell--rank" role="columnheader">#</span>
                    <span class="mvp-table__cell mvp-table__cell--player" role="columnheader">Player</span>
                    <span class="mvp-table__cell mvp-table__cell--score" role="columnheader">Total</span>
                    <span class="mvp-table__cell mvp-table__cell--average" role="columnheader">Avg</span>
                    <span class="mvp-table__cell mvp-table__cell--best" role="columnheader">Best</span>
                    <span class="mvp-table__cell mvp-table__cell--combats" role="columnheader">Battles</span>
                </div>

                {{#each leaderboard}}
                <div class="mvp-table__row" role="row">
                    <span class="mvp-table__cell mvp-table__cell--rank" role="cell">{{rank}}</span>
                    <span class="mvp-table__cell mvp-table__cell--player" role="cell">
                        <img class="mvp-player__portrait" src="{{img}}" alt="{{name}}" data-tooltip="{{name}}">
                        <span class="mvp-player__name"></span>
                    </span>
                    <span class="mvp-table__cell mvp-table__cell--score" role="cell">{{totalScoreDisplay}}</span>
                    <span class="mvp-table__cell mvp-table__cell--average" role="cell">{{averageScoreDisplay}}</span>
                    <span class="mvp-table__cell mvp-table__cell--best" role="cell">{{bestScoreDisplay}}</span>
                    <span class="mvp-table__cell mvp-table__cell--combats" role="cell">{{combats}}</span>
                </div>
                {{/each}}
            </div>
            {{else}}
            <div class="mvp-panel__empty">
                <i class="fas fa-moon"></i>
                <span>No MVP data. Complete a combat to start the leaderboard.</span>
            </div>
            {{/if}}
        {{else}}
            <div class="mvp-panel__empty">
                <i class="fas fa-plug"></i>
                {{#if isGM}}
                    <span>Blacksmith stats are unavailable. Ensure Coffee Pub Blacksmith is active and tracking player stats.</span>
                {{else}}
                    <span>Party MVP data can be viewed by the GM when Blacksmith stats tracking is enabled.</span>
                {{/if}}
            </div>
        {{/if}}
    </div>
</div>