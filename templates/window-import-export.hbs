{{!-- Shared Import/Export Dialog Template --}}
{{!-- 
  Usage:
  {{> "modules/coffee-pub-squire/templates/window-import-export" 
    type="quests|codex" 
    isImport=true|false
    isExport=true|false
    jsonInputId="unique-input-id"
    jsonOutputId="unique-output-id"
    exportData="JSON string to display"
    exportSummary="Export summary object"
    scenePins="Scene pins data"
    hasScenePins=true
  }}
--}}

{{#if isImport}}
  {{!-- ************* IMPORT ************* --}}

  {{!-- Template Copy Button --}}
  <div style="margin-bottom: 16px;">
    <strong>Base Prompt Template</strong><br>
        <button type="button" class="copy-template-button" style="margin: 8px 8px 8px 0; padding: 8px 16px; background: #522c34; color: white; border: none; border-radius: 4px; cursor: pointer;">
      <i class="fas fa-copy"></i> Copy to Clipboard
    </button>
    <hr>
  </div>

  {{!-- JSON Import or Paste --}}
  <div style="margin-bottom: 8px;">
    <strong>Select or Paste JSON</strong>
    <button type="button" class="browse-file-button" style="margin: 8px 8px 8px 0; padding: 8px 16px; background: #28542b; color: white; border: none; border-radius: 4px; cursor: pointer;">
      <i class="fas fa-folder-open"></i> Select JSON File
    </button>
  </div>
  <textarea id="{{jsonInputId}}" style="width:100%;height:400px;resize:vertical;"></textarea>  
  <input type="file" id="import-file-input" accept=".json" style="display: none;">

  {{!-- Codex Details --}}
  {{#if (eq type "codex")}}
  <div style="margin-bottom: 12px;">
    <hr>
    <strong>Codex Smart Import</strong><br>
    <ul>
      <li>Existing Codex entries are updated, not duplicated</li>
      <li>Visibility states are preserved</li>
      <li>After import, run auto-discovery to enable the items the party has already discovered</li>
    </ul>
    <hr>
  </div>
  {{/if}}

  {{!-- Quest Details --}}
  {{#if (eq type "quests")}}
  <div style="margin-bottom: 12px;">
    <hr>
    <strong>Quest Smart Import</strong><br>
    <ul>
      <li>Existing Quest entries are updated, not duplicated</li>
      <li>Progress and states are preserved</li>
      <li>Scene pins are merged intelligently</li>
      <li>Pin positions and associations maintained</li>
    </ul>
    <hr>
  </div>
  {{/if}}


{{else if isExport}}
  {{!-- ************* EXPORT ************* --}}

  {{!-- Title --}}
  <div style="margin-bottom: 8px;">
     {{#if (eq type "quests")}}
      <strong>Quests and Scene Pins JSON</strong>
     {{else if (eq type "codex")}}
      <strong>Codex JSON</strong>
     {{/if}}
  </div>
  
  {{!-- JSON Text --}}
  <textarea id="{{jsonOutputId}}" style="width:100%;height:500px;resize:vertical;">{{exportData}}</textarea>

  {{!-- Export Summary --}}
  {{#if exportSummary}}
  <div style="margin-bottom: 8px;">
    <hr>
    <strong>Export Summary</strong><br>
    <ul>
      {{#if exportSummary.totalItems}}
        <li><strong>Total Exported:</strong> {{exportSummary.totalItems}} {{type}}</li>
      {{/if}}
      {{#if exportSummary.totalScenes}}
        <li><strong>Scenes:</strong> {{exportSummary.totalScenes}} scenes with {{type}} pins</li>
      {{/if}}
      {{#if exportSummary.totalPins}}
      <li><strong>Pins:</strong> {{exportSummary.totalPins}} total {{type}} pins</strong></li>
      {{/if}}
      {{#if exportSummary.exportVersion}}
        <li><strong>Timestamp:</strong> v{{exportSummary.exportVersion}} at {{exportSummary.timestamp}}</li>
      {{/if}}
    </ul>
    <hr>
  </div>
  {{/if}}
  
  {{#if scenePins}}
    {{#if hasScenePins}}
      <div style="margin-bottom: 8px;">
        <strong>Scene Pins:</strong> {{#each scenePins}}<label style="color:rgb(13, 97, 16);">{{this.sceneName}}</label>{{#unless @last}}, {{/unless}}{{/each}}
        <hr>
      </div>
    {{else}}
      <div style="margin-bottom: 8px;">
        <strong>Scene Pins:</strong> <label style="color:rgb(167, 106, 14);">No scenes currently have {{type}} pins placed.</label>
        <hr>
      </div>
    {{/if}}
  {{/if}}




{{/if}}
