<form class="notes-form" method="post">
    <div class="notes-form-header">
        <div class="notes-form-header-content">
            <div class="notes-form-header-icon">
                {{#if note.iconHtml}}
                    {{{note.iconHtml}}}
                {{else}}
                    <i class="fa-solid fa-note-sticky"></i>
                {{/if}}
            </div>
            <div class="notes-form-header-title">
                <input type="text" id="title" name="title" class="notes-form-title-input" value="{{#if note.title}}{{note.title}}{{/if}}" placeholder="Note title" required>
                <div class="notes-form-meta">
                    <span class="notes-form-meta-item">Author: {{#if note.authorName}}{{note.authorName}}{{else}}Unknown{{/if}}</span>
                    {{#if note.timestamp}}
                        <span class="notes-form-meta-item">Created: {{formatTimestamp note.timestamp}}</span>
                    {{else}}
                        <span class="notes-form-meta-item">Created: Not saved yet</span>
                    {{/if}}
                </div>
            </div>
            <div class="notes-form-header-controls">
                <div class="notes-visibility-toggle-container">
                    <span class="notes-visibility-toggle-label">Private</span>
                    <div class="notes-visibility-toggle">
                        <input type="checkbox" name="visibilityPrivate" id="notes-visibility-private" {{#if (eq note.visibility 'private')}}checked{{/if}}>
                        <label for="notes-visibility-private" class="notes-visibility-toggle-slider"></label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="notes-form-body">
    <!-- Hidden fields -->
    <input type="hidden" name="sceneId" value="{{#if note.sceneId}}{{note.sceneId}}{{/if}}">
    <input type="hidden" name="x" value="{{#if note.x}}{{note.x}}{{/if}}">
    <input type="hidden" name="y" value="{{#if note.y}}{{note.y}}{{/if}}">

    <!-- Content -->
    <div class="notes-section notes-section-editor">
        <div class="notes-section-header"><i class="fa-solid fa-align-left"></i> Content</div>
        <div class="notes-section-body">
            {{editor note.content target="content" button=false owner=true editable=true engine="prosemirror"}}
        </div>
    </div>

    <!-- Tags -->
    <div class="notes-section">
        <div class="notes-section-header"><i class="fa-solid fa-tags"></i> Tags</div>
        <div class="notes-section-body">
            <input type="text" id="tags" name="tags" class="notes-input" value="{{note.tagsText}}" placeholder="npc, phlan, informant">
            <div class="tag-suggestions">
                {{#unless note.tagsText}}
                    <small>Enter tags separated by commas...</small>
                {{/unless}}
            </div>
        </div>
    </div>

    <!-- Scene Info (if from canvas) -->
    {{#if sceneName}}
    <div class="notes-section">
        <div class="notes-section-header"><i class="fa-solid fa-map-pin"></i> Location</div>
        <div class="notes-section-body scene-info">
            <p>{{sceneName}}</p>
        </div>
    </div>
    {{/if}}

    </div>

    <!-- Action Buttons -->
    <div class="form-actions">
        <button type="button" class="btn-secondary cancel">
            <i class="fa-solid fa-times"></i> Cancel
        </button>
        <button type="submit" class="btn-primary">
            <i class="fa-solid fa-save"></i> Save Note
        </button>
    </div>
</form>
