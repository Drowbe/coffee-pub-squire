<form class="notes-form" method="post">
    <!-- Hidden fields -->
    <input type="hidden" name="img" value="{{#if note.img}}{{note.img}}{{/if}}">
    <input type="hidden" name="sceneId" value="{{#if note.sceneId}}{{note.sceneId}}{{/if}}">
    <input type="hidden" name="x" value="{{#if note.x}}{{note.x}}{{/if}}">
    <input type="hidden" name="y" value="{{#if note.y}}{{note.y}}{{/if}}">

    <!-- Title -->
    <div class="form-group">
        <label for="title">Title *</label>
        <input type="text" id="title" name="title" value="{{#if note.title}}{{note.title}}{{/if}}" placeholder="Note title" required>
    </div>

    <!-- Image Section -->
    <div class="notes-image-section" style="{{#unless note.img}}display: none;{{/unless}}">
        <label>Image</label>
        <div class="notes-image-preview-wrapper">
            <img class="notes-image-preview" src="{{#if note.img}}{{note.img}}{{/if}}" alt="Preview">
            <button type="button" class="notes-remove-image">
                <i class="fa-solid fa-times"></i>
            </button>
        </div>
    </div>

    <!-- Image Drop Zone -->
    <div class="notes-image-drop-zone">
        <div class="drop-zone-content">
            <i class="fa-solid fa-image"></i>
            <p>Drag image here or paste from clipboard</p>
            <input type="file" accept="image/*" style="display: none;" id="image-file-input">
            <button type="button" class="btn-small" onclick="document.getElementById('image-file-input').click()">
                <i class="fa-solid fa-folder-open"></i> Browse
            </button>
        </div>
    </div>

    <!-- Content -->
    <div class="form-group">
        <label for="content">Content</label>
        <textarea id="content" name="content" rows="6" placeholder="Type your note here... Markdown supported.">{{#if note.content}}{{note.content}}{{/if}}</textarea>
    </div>

    <!-- Tags -->
    <div class="form-group">
        <label for="tags">Tags (comma-separated)</label>
        <input type="text" id="tags" name="tags" value="{{#if note.tags}}{{#if (isArray note.tags)}}{{note.tags.join ', '}}{{else}}{{note.tags}}{{/if}}{{/if}}" placeholder="npc, phlan, informant">
        <div class="tag-suggestions">
            <small>Enter tags separated by commas</small>
        </div>
    </div>

    <!-- Visibility -->
    <div class="form-group">
        <label>Visibility</label>
        <div class="visibility-toggle">
            <label class="toggle-option">
                <input type="radio" name="visibility" value="private" {{#unless (eq note.visibility 'party')}}checked{{/unless}}>
                <span><i class="fa-solid fa-lock"></i> Private</span>
                <small>Only you can see this note</small>
            </label>
            <label class="toggle-option">
                <input type="radio" name="visibility" value="party" {{#if (eq note.visibility 'party')}}checked{{/if}}>
                <span><i class="fa-solid fa-users"></i> Party</span>
                <small>All players can see this note</small>
            </label>
        </div>
    </div>

    <!-- Scene Info (if from canvas) -->
    {{#if sceneName}}
    <div class="form-group scene-info">
        <label>Location</label>
        <p><i class="fa-solid fa-map-pin"></i> {{sceneName}}</p>
    </div>
    {{/if}}

    <!-- Action Buttons -->
    <div class="form-actions">
        <button type="submit" class="btn-primary">
            <i class="fa-solid fa-save"></i> Save Note
        </button>
        <button type="button" class="btn-secondary cancel">
            <i class="fa-solid fa-times"></i> Cancel
        </button>
    </div>
</form>
